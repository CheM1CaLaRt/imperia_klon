# Настройка Dadata API для автозаполнения адресов

## Что такое Dadata API?

Dadata API — это сервис для работы с адресами, компаниями и другими данными. 
**Бесплатный тариф:** до 10,000 запросов в день.

## Регистрация и получение ключа

1. Перейдите на https://dadata.ru/api/
2. Зарегистрируйтесь или войдите в аккаунт
3. Перейдите в раздел "API" → "Подсказки" → "Адреса"
4. Скопируйте ваш **API Token**
5. Если используется Secret Key, скопируйте его тоже (для некоторых тарифов не требуется)

## Настройка в проекте

1. Создайте файл `.env` в корне проекта `imperia/` (рядом с `manage.py`), если его нет
2. Добавьте следующие строки:

```env
DADATA_API_TOKEN=ваш_токен_здесь
DADATA_API_SECRET=ваш_секрет_здесь
```

**Примечание:** 
- `DADATA_API_TOKEN` — обязателен
- `DADATA_API_SECRET` — может быть необязательным в зависимости от вашего тарифа (можно не указывать)

## Пример

```env
DADATA_API_TOKEN=1234567890abcdef1234567890abcdef
DADATA_API_SECRET=9876543210fedcba9876543210fedcba
```

Или только токен (если Secret не требуется):

```env
DADATA_API_TOKEN=1234567890abcdef1234567890abcdef
```

## Проверка работы

После добавления ключей:
1. **Перезапустите Django сервер** (важно!)
2. Откройте форму редактирования контрагента
3. Начните вводить адрес в поле "Адрес доставки" (например: "проспект маршала")
4. Должны появиться подсказки от Dadata API

## Отладка

Если подсказки не появляются:
1. Проверьте, что файл `.env` находится в папке `imperia/` (рядом с `manage.py`)
2. Проверьте, что токен указан правильно (без пробелов, кавычек)
3. Проверьте логи Django сервера — там должны быть сообщения о работе Dadata API
4. Убедитесь, что перезапустили сервер после добавления переменных

## Альтернативы

Если Dadata API не настроен, система автоматически использует:
- Photon API (бесплатный, без ключа)
- Nominatim (OpenStreetMap, бесплатный, без ключа)

Но Dadata API дает **лучшие результаты** для российских адресов.

