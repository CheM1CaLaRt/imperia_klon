# core/services/bank_search.py
"""
Справочник банков России с БИК
Источник: https://www.bankodrom.ru/banki-rossii/spravochnik-bik-bankov-rf/
"""

# Список популярных банков России с БИК
# Источник: https://www.bankodrom.ru/banki-rossii/spravochnik-bik-bankov-rf/
BANKS_DATA = [
    {"name": "Альфа-банк", "bik": "044525593"},
    {"name": "Сбербанк России", "bik": "044525225"},
    {"name": "ПАО Сбербанк", "bik": "044525225"},
    {"name": "ВТБ", "bik": "044525187"},
    {"name": "ПАО ВТБ", "bik": "044525187"},
    {"name": "ВТБ 24", "bik": "044525187"},
    {"name": "Газпромбанк", "bik": "044525823"},
    {"name": "ПАО Газпромбанк", "bik": "044525823"},
    {"name": "Россельхозбанк", "bik": "044525111"},
    {"name": "АО Россельхозбанк", "bik": "044525111"},
    {"name": "Райффайзенбанк", "bik": "044525700"},
    {"name": "АО Райффайзенбанк", "bik": "044525700"},
    {"name": "ЮниКредит Банк", "bik": "044525787"},
    {"name": "АО ЮниКредит Банк", "bik": "044525787"},
    {"name": "Росбанк", "bik": "044525256"},
    {"name": "АО Росбанк", "bik": "044525256"},
    {"name": "Открытие", "bik": "044525192"},
    {"name": "ПАО Банк ФК Открытие", "bik": "044525192"},
    {"name": "Банк ФК Открытие", "bik": "044525192"},
    {"name": "Промсвязьбанк", "bik": "044525220"},
    {"name": "ПАО Промсвязьбанк", "bik": "044525220"},
    {"name": "МКБ", "bik": "044525201"},
    {"name": "АО МКБ", "bik": "044525201"},
    {"name": "Ак Барс", "bik": "049205805"},
    {"name": "АО Ак Барс Банк", "bik": "049205805"},
    {"name": "Тинькофф Банк", "bik": "044525974"},
    {"name": "АО Тинькофф Банк", "bik": "044525974"},
    {"name": "Совкомбанк", "bik": "044525411"},
    {"name": "ПАО Совкомбанк", "bik": "044525411"},
    {"name": "Хоум Кредит Банк", "bik": "044525911"},
    {"name": "АО Хоум Кредит энд Финанс Банк", "bik": "044525911"},
    {"name": "Ренессанс Кредит", "bik": "044525174"},
    {"name": "АО Ренессанс Кредит", "bik": "044525174"},
    {"name": "ОТП Банк", "bik": "044525121"},
    {"name": "АО ОТП Банк", "bik": "044525121"},
    {"name": "Русский Стандарт", "bik": "044525416"},
    {"name": "АО Русский Стандарт", "bik": "044525416"},
    {"name": "МТС Банк", "bik": "044525503"},
    {"name": "ПАО МТС Банк", "bik": "044525503"},
    {"name": "Почта Банк", "bik": "044525106"},
    {"name": "ПАО Почта Банк", "bik": "044525106"},
    {"name": "Абсолют Банк", "bik": "044525976"},
    {"name": "ПАО Абсолют Банк", "bik": "044525976"},
    {"name": "Авангард", "bik": "044525201"},
    {"name": "АО Авангард", "bik": "044525201"},
    {"name": "Америкэн Экспресс Банк", "bik": "044525717"},
    {"name": "АО Америкэн Экспресс Банк", "bik": "044525717"},
    {"name": "Банк Санкт-Петербург", "bik": "044030790"},
    {"name": "АО Банк Санкт-Петербург", "bik": "044030790"},
    {"name": "Банк Возрождение", "bik": "044525181"},
    {"name": "ПАО Банк Возрождение", "bik": "044525181"},
    {"name": "Банк Зенит", "bik": "044525093"},
    {"name": "ПАО Банк Зенит", "bik": "044525093"},
    {"name": "Банк Интеза", "bik": "044525700"},
    {"name": "АО Банк Интеза", "bik": "044525700"},
    {"name": "Банк ЦентрИнвест", "bik": "046015207"},
    {"name": "АО Банк ЦентрИнвест", "bik": "046015207"},
    {"name": "Яндекс.Банк", "bik": "044525974"},
    {"name": "АО Яндекс.Банк", "bik": "044525974"},
]


def search_banks(query: str, limit: int = 20) -> list:
    """
    Поиск банков по первым символам названия
    
    Args:
        query: Поисковый запрос (минимум 3 символа)
        limit: Максимальное количество результатов
    
    Returns:
        Список словарей с ключами 'name' и 'bik'
    """
    if len(query) < 3:
        return []
    
    query_lower = query.lower()
    results = []
    
    for bank in BANKS_DATA:
        if query_lower in bank["name"].lower():
            results.append(bank)
            if len(results) >= limit:
                break
    
    return results


def get_bank_by_bik(bik: str) -> dict:
    """
    Получить банк по БИК
    
    Args:
        bik: БИК банка (9 цифр)
    
    Returns:
        Словарь с ключами 'name' и 'bik' или None
    """
    for bank in BANKS_DATA:
        if bank["bik"] == bik:
            return bank
    return None

