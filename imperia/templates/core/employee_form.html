{% extends "base.html" %}

{% block title %}{{ title }} — IndigoFlow{% endblock %}

{% block content %}
<div class="card">
  <div class="card-header">
    <div>
      <h1 class="card-title">{{ title }}</h1>
      <p class="card-subtitle">
        {% if action == "edit" %}
          Редактирование данных сотрудника
        {% else %}
          Заполните форму для создания нового сотрудника
        {% endif %}
      </p>
    </div>
    <a href="{% url 'core:employee_list' %}" class="btn btn-secondary">← Назад к списку</a>
  </div>

  <form method="post" style="padding:24px;display:grid;gap:24px">
    {% csrf_token %}
    
    {% if form.non_field_errors %}
      <div style="padding:14px 18px;background:#fee2e2;border:1px solid #fecaca;border-radius:12px;color:#7f1d1d;font-size:14px">
        {{ form.non_field_errors }}
      </div>
    {% endif %}

    <!-- Основная информация -->
    <div style="display:grid;gap:20px;padding:20px;background:var(--bg);border-radius:16px;border:1px solid var(--border)">
      <h2 style="margin:0;font-size:18px;font-weight:600;color:var(--text)">Основная информация</h2>
      
      <div class="grid grid-2" style="gap:20px">
        <div class="field">
          <label class="field label">{{ form.username.label }} <span style="color:#ef4444">*</span></label>
          {{ form.username }}
          {% if form.username.errors %}
            <div style="color:#ef4444;font-size:13px;margin-top:6px">{{ form.username.errors }}</div>
          {% endif %}
          {% if form.username.help_text %}
            <div style="margin-top:6px;font-size:13px;color:var(--muted)">{{ form.username.help_text }}</div>
          {% endif %}
        </div>
        
        <div class="field">
          <label class="field label">{{ form.role.label }} <span style="color:#ef4444">*</span></label>
          {{ form.role }}
          {% if form.role.errors %}
            <div style="color:#ef4444;font-size:13px;margin-top:6px">{{ form.role.errors }}</div>
          {% endif %}
          {% if form.role.help_text %}
            <div style="margin-top:6px;font-size:13px;color:var(--muted)">{{ form.role.help_text }}</div>
          {% endif %}
        </div>
      </div>

      <div class="grid grid-2" style="gap:20px">
        <div class="field">
          <label class="field label">{{ form.first_name.label }} <span style="color:#ef4444">*</span></label>
          {{ form.first_name }}
          {% if form.first_name.errors %}
            <div style="color:#ef4444;font-size:13px;margin-top:6px">{{ form.first_name.errors }}</div>
          {% endif %}
        </div>
        
        <div class="field">
          <label class="field label">{{ form.last_name.label }}</label>
          {{ form.last_name }}
          {% if form.last_name.errors %}
            <div style="color:#ef4444;font-size:13px;margin-top:6px">{{ form.last_name.errors }}</div>
          {% endif %}
        </div>
      </div>

      <div class="field">
        <label class="field label">{{ form.email.label }}</label>
        {{ form.email }}
        {% if form.email.errors %}
          <div style="color:#ef4444;font-size:13px;margin-top:6px">{{ form.email.errors }}</div>
        {% endif %}
      </div>

      <div class="field">
        <label class="field label">{{ form.password.label }} {% if action == "create" %}<span style="color:#ef4444">*</span>{% endif %}</label>
        {{ form.password }}
        {% if form.password.errors %}
          <div style="color:#ef4444;font-size:13px;margin-top:6px">{{ form.password.errors }}</div>
        {% endif %}
        {% if form.password.help_text %}
          <div style="margin-top:6px;font-size:13px;color:var(--muted)">{{ form.password.help_text }}</div>
        {% endif %}
      </div>

      <div class="field" style="display:flex;align-items:center;gap:12px;padding:12px;background:var(--card);border-radius:8px">
        {{ form.is_active }}
        <label for="{{ form.is_active.id_for_label }}" style="cursor:pointer;font-size:14px;font-weight:500">
          {{ form.is_active.label }}
        </label>
        {% if form.is_active.help_text %}
          <span style="font-size:12px;color:var(--muted);margin-left:auto">{{ form.is_active.help_text }}</span>
        {% endif %}
      </div>
    </div>

    <!-- Контактная информация -->
    <div style="display:grid;gap:20px;padding:20px;background:var(--bg);border-radius:16px;border:1px solid var(--border)">
      <h2 style="margin:0;font-size:18px;font-weight:600;color:var(--text)">Контактная информация</h2>
      
      <div class="grid grid-2" style="gap:20px">
        <div class="field">
          <label class="field label">{{ form.phone.label }}</label>
          {{ form.phone }}
          {% if form.phone.errors %}
            <div style="color:#ef4444;font-size:13px;margin-top:6px">{{ form.phone.errors }}</div>
          {% endif %}
        </div>
        
        <div class="field">
          <label class="field label">{{ form.telegram.label }}</label>
          {{ form.telegram }}
          {% if form.telegram.errors %}
            <div style="color:#ef4444;font-size:13px;margin-top:6px">{{ form.telegram.errors }}</div>
          {% endif %}
        </div>
      </div>

      <div class="grid grid-2" style="gap:20px">
        <div class="field">
          <label class="field label">{{ form.whatsapp.label }}</label>
          {{ form.whatsapp }}
          {% if form.whatsapp.errors %}
            <div style="color:#ef4444;font-size:13px;margin-top:6px">{{ form.whatsapp.errors }}</div>
          {% endif %}
        </div>
        
        <div class="field">
          <label class="field label">{{ form.vk.label }}</label>
          {{ form.vk }}
          {% if form.vk.errors %}
            <div style="color:#ef4444;font-size:13px;margin-top:6px">{{ form.vk.errors }}</div>
          {% endif %}
        </div>
      </div>

      <div class="field">
        <label class="field label">{{ form.birth_date.label }}</label>
        {{ form.birth_date }}
        {% if form.birth_date.errors %}
          <div style="color:#ef4444;font-size:13px;margin-top:6px">{{ form.birth_date.errors }}</div>
        {% endif %}
      </div>
    </div>

    <!-- Кнопки действий -->
    <div style="display:flex;gap:12px;padding-top:16px;border-top:1px solid var(--border);flex-wrap:wrap">
      <button type="submit" class="btn btn-primary" style="flex:1;min-width:140px">
        {% if action == "edit" %}Сохранить изменения{% else %}Создать сотрудника{% endif %}
      </button>
      <a href="{% url 'core:employee_list' %}" class="btn" style="background:var(--card);border-color:var(--border);color:var(--text)">Отмена</a>
    </div>
  </form>
</div>

<style>
@media (max-width:640px){
  .grid-2{grid-template-columns:1fr}
  .card-header{flex-direction:column;align-items:stretch;gap:12px}
  .card-header .btn{width:100%;justify-content:center}
}
</style>
{% endblock %}

